# 🏔️ 游侠客游客管理工具

基于Streamlit开发的Web版游侠客游客管理系统，提供简单易用的界面来管理游客信息。

## ✨ 功能特性

- 🔍 **查询用户列表** - 实时查看当前系统中的所有游客信息
- 📁 **Excel文件导入** - 支持批量导入游客信息
- ➕ **手动添加用户** - 单个用户信息录入
- 🗑️ **批量删除用户** - 支持选择和批量删除游客
- 📊 **数据对比分析** - Excel数据与系统数据对比
- ⚡ **批量操作** - 一键批量添加、清空等操作

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 启动应用

**方法一：使用启动脚本（推荐）**
```bash
# Windows批处理文件
start.bat

# 或者PowerShell脚本
start.ps1
```

**方法二：直接命令行启动**
```bash
python -m streamlit run streamlit_app.py
```

### 3. 访问应用

打开浏览器访问：http://localhost:8501

**注意：** 如果看到邮箱输入提示，直接按回车跳过即可。

## 📖 使用说明

### 基本操作流程

1. **刷新用户列表**
   - 点击侧边栏的"🔄 刷新用户列表"按钮
   - 系统会查询当前游侠客网站中的所有游客信息

2. **导入Excel文件**
   - 在侧边栏点击"选择Excel文件"
   - 上传包含游客信息的Excel文件
   - 点击"📖 读取Excel"解析文件内容

3. **批量添加用户**
   - 确保已导入Excel文件
   - 点击"➕ 批量添加"按钮
   - 系统会逐个添加用户到游侠客网站

4. **手动添加用户**
   - 切换到"➕ 添加用户"标签页
   - 填写用户信息表单
   - 点击"➕ 添加用户"按钮

5. **删除用户**
   - 在"📋 用户列表"标签页选择要删除的用户
   - 点击"🗑️ 删除选中用户"按钮

6. **数据对比**
   - 切换到"📊 数据对比"标签页
   - 查看Excel数据与系统数据的对比结果
   - 可下载对比结果CSV文件

### Excel文件格式要求

Excel文件应包含以下列（列名可包含关键词）：

| 列名 | 说明 | 示例 |
|------|------|------|
| 姓名 | 游客真实姓名 | 张三 |
| 手机号 | 联系电话 | 13800138000 |
| 身份证号 | 身份证号码 | 110101199001011234 |
| 性别 | 男/女 | 男 |
| 类型 | 成人/儿童 | 成人 |

## 🔧 技术栈

- **前端**: Streamlit
- **后端**: Python
- **数据处理**: Pandas
- **网络请求**: Requests
- **HTML解析**: BeautifulSoup

## 📁 项目结构

```
youxiake_tools/
├── streamlit_app.py          # Streamlit主应用
├── youxiake_tourist.py       # 核心功能模块
├── yxk_clent.py             # PyQt5桌面版
├── requirements.txt         # 依赖文件
├── README.md               # 使用说明
└── temp_upload.xlsx        # 临时上传文件（运行时生成）
```

## ⚠️ 注意事项

1. **Cookie更新**: 需要定期更新`youxiake_tourist.py`中的Cookie信息
2. **网络连接**: 确保网络连接正常，能够访问游侠客网站
3. **文件格式**: Excel文件必须是.xlsx或.xls格式
4. **数据备份**: 建议在批量操作前备份重要数据

## 🐛 故障排除

### 常见问题

1. **无法查询用户列表**
   - 检查网络连接
   - 更新Cookie信息
   - 确认游侠客网站可正常访问

2. **Excel文件读取失败**
   - 检查文件格式是否为xlsx/xls
   - 确认文件包含必要的列名
   - 检查文件是否损坏

3. **添加用户失败**
   - 检查用户信息是否完整
   - 确认身份证号格式正确
   - 检查网络连接状态

## 📞 技术支持

如有问题或建议，请检查：
1. Python版本 >= 3.7
2. 依赖包是否正确安装
3. 网络连接是否正常
4. Cookie信息是否有效

## 🔄 版本更新

- **v1.0.0** - 初始版本，支持基本的增删改查功能
- **v1.1.0** - 添加Streamlit Web界面
- **v1.2.0** - 增加数据对比和批量操作功能

---

**🏔️ 游侠客游客管理工具** - 让游客管理更简单！
